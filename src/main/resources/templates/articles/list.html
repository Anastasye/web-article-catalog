<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Å–µ —Å—Ç–∞—Ç—å–∏</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
    <div class="container">
        <header class="header">
            <h1>üìö –ö–∞—Ç–∞–ª–æ–≥ —Å—Ç–∞—Ç–µ–π</h1>
            <div class="auth-section">
                <span sec:authentication="name"></span>
                <a th:href="@{/logout}" class="btn btn-logout">–í—ã–π—Ç–∏</a>
            </div>
        </header>

        <nav class="main-nav">
            <a th:href="@{/}" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <a th:href="@{/articles}" class="nav-link active">–í—Å–µ —Å—Ç–∞—Ç—å–∏</a>
            <a th:href="@{/articles/my}" class="nav-link">–ú–æ–∏ —Å—Ç–∞—Ç—å–∏</a>
            <a th:href="@{/articles/add}" class="nav-link">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é</a>
            <a th:href="@{/user/profile}" class="nav-link">–ü—Ä–æ—Ñ–∏–ª—å</a>
            <a th:href="@{/user/search}" class="nav-link">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</a>
        </nav>

        <main>
            <section class="dashboard">
                <h2>–í—Å–µ —Å—Ç–∞—Ç—å–∏</h2>

                <!-- 2.3 –°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ -->
                <div class="search-section">
                    <form th:action="@{/articles}" method="get" class="search-form">
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" name="author" th:value="${selectedAuthor}" placeholder="–ê–≤—Ç–æ—Ä..."
                                    class="form-control">
                            </div>
                            <div class="form-group">
                                <select name="topic" class="form-control">
                                    <option value="">–í—Å–µ —Ç–µ–º—ã</option>
                                    <option th:each="topic : ${topics}" th:value="${topic}" th:text="${topic}"
                                        th:selected="${topic == selectedTopic}">
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <input type="text" name="keyword" th:value="${selectedKeyword}"
                                    placeholder="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞..." class="form-control">
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">–ù–∞–π—Ç–∏</button>
                                <a th:href="@{/articles}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
                <div class="articles-list">
                    <div class="results-header">
                        <h3>–ù–∞–π–¥–µ–Ω–æ —Å—Ç–∞—Ç–µ–π: <span th:text="${totalItems}">0</span></h3>
                    </div>

                    <div th:if="${articles.empty}" class="no-results">
                        <p>–°—Ç–∞—Ç—å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞.</p>
                    </div>

                    <div th:unless="${articles.empty}" class="articles-grid">
                        <div th:each="article : ${articles}" class="article-card">
                            <h4 th:text="${article.title}">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</h4>
                            <p class="authors"><strong>–ê–≤—Ç–æ—Ä—ã:</strong> <span th:text="${article.authors}"></span></p>
                            <p class="meta">
                                <strong>–¢–µ–º–∞:</strong> <span th:text="${article.topic}">–¢–µ–º–∞</span> |
                                <strong>–ì–æ–¥:</strong> <span th:text="${article.publicationYear}">–ì–æ–¥</span> |
                                <strong>–î–æ–±–∞–≤–∏–ª:</strong> <a th:href="@{'/user/' + ${article.user.id}}"
                                    th:text="${article.user.username}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</a>
                            </p>
                            <p class="keywords" th:if="${article.keywords}">
                                <strong>–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</strong> <span th:text="${article.keywords}"></span>
                            </p>
                            <div class="article-actions">
                                <a th:href="@{'/articles/view/' + ${article.id}}"
                                    class="btn btn-sm btn-info">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                                <a th:href="@{'/articles/download/' + ${article.id}}"
                                    class="btn btn-sm btn-primary">–°–∫–∞—á–∞—Ç—å PDF</a>
                            </div>
                        </div>
                    </div>

                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                    <div th:if="${totalPages > 1}" class="pagination">
                        <a th:if="${currentPage > 0}"
                            th:href="@{/articles(page=${currentPage - 1}, author=${selectedAuthor}, topic=${selectedTopic}, keyword=${selectedKeyword})}"
                            class="btn btn-sm">‚Üê –ù–∞–∑–∞–¥</a>

                        <span class="page-info">
                            –°—Ç—Ä–∞–Ω–∏—Ü–∞ <span th:text="${currentPage + 1}">1</span> –∏–∑ <span
                                th:text="${totalPages}">1</span>
                        </span>

                        <a th:if="${currentPage < totalPages - 1}"
                            th:href="@{/articles(page=${currentPage + 1}, author=${selectedAuthor}, topic=${selectedTopic}, keyword=${selectedKeyword})}"
                            class="btn btn-sm">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
                    </div>
                </div>
            </section>
        </main>

    </div>
</body>

</html>