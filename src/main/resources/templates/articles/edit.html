<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
    <div class="container">
        <header class="header">
            <h1>üìö –ö–∞—Ç–∞–ª–æ–≥ —Å—Ç–∞—Ç–µ–π</h1>
            <div class="auth-section">
                <span th:text="${#authentication.name}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                <a th:href="@{/logout}" class="btn btn-logout">–í—ã–π—Ç–∏</a>
            </div>
        </header>

        <nav class="main-nav">
            <a th:href="@{/}" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <a th:href="@{/articles}" class="nav-link">–í—Å–µ —Å—Ç–∞—Ç—å–∏</a>
            <a th:href="@{/articles/my}" class="nav-link">–ú–æ–∏ —Å—Ç–∞—Ç—å–∏</a>
            <a th:href="@{/articles/add}" class="nav-link">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é</a>
            <a th:href="@{/user/profile}" class="nav-link">–ü—Ä–æ—Ñ–∏–ª—å</a>
        </nav>

        <main>
            <section class="dashboard">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é</h2>

                <div th:if="${errorMessage}" class="alert alert-error" th:text="${errorMessage}"></div>

                <div class="alert alert-info">
                    <p><strong>–¢–µ–∫—É—â–∏–π PDF —Ñ–∞–π–ª:</strong> <span th:text="${article.pdfFileName}"></span></p>
                    <a th:href="@{'/articles/download/' + ${article.id}}" class="btn btn-sm btn-primary">
                        –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª
                    </a>
                </div>

                <form th:action="@{'/articles/edit/' + ${article.id}}" method="post" enctype="multipart/form-data"
                    class="article-form">

                    <!-- –ó–∞–º–µ–Ω–∞ PDF —Ñ–∞–π–ª–∞ -->
                    <div class="form-group">
                        <label for="pdfFile">–ó–∞–º–µ–Ω–∏—Ç—å PDF —Ñ–∞–π–ª (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="file" id="pdfFile" name="pdfFile" accept=".pdf" class="form-control">
                        <small>–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å —Ñ–∞–π–ª. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10 MB</small>
                    </div>

                    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
                    <div class="form-group">
                        <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ *</label>
                        <input type="text" id="title" name="title" required class="form-control"
                            th:value="${article.title}">
                    </div>

                    <!-- –ê–≤—Ç–æ—Ä—ã -->
                    <div class="form-group">
                        <label for="authors">–ê–≤—Ç–æ—Ä—ã *</label>
                        <input type="text" id="authors" name="authors" required class="form-control"
                            th:value="${article.authors}">
                    </div>

                    <!-- –ì–æ–¥ -->
                    <div class="form-group">
                        <label for="publicationYear">–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è</label>
                        <input type="number" id="publicationYear" name="publicationYear" min="1900" max="2025"
                            class="form-control" th:value="${article.publicationYear}">
                    </div>

                    <!-- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ -->
                    <div class="form-group">
                        <label for="keywords">–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞</label>
                        <input type="text" id="keywords" name="keywords" class="form-control"
                            th:value="${article.keywords}">
                    </div>

                    <!-- –¢–µ–º–∞ -->
                    <div class="form-group">
                        <label for="topic">–¢–µ–º–∞/—Ä–∞–∑–¥–µ–ª</label>
                        <input type="text" id="topic" name="topic" class="form-control"
                            th:value="${article.topic != null ? article.topic : ''}"
                            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ">
                        <small>–ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö:</small>
                        <select onchange="document.getElementById('topic').value = this.value;" style="margin-top: 5px;"
                            class="form-control">
                            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞ --</option>
                            <option th:each="topicOption : ${topics}" th:value="${topicOption}" th:text="${topicOption}"
                                th:selected="${topicOption == article.topic}">
                            </option>
                        </select>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é</button>
                        <a th:href="@{'/articles/view/' + ${article.id}}" class="btn btn-info">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                        <a th:href="@{/articles/my}" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
                        <form th:action="@{'/articles/delete/' + ${article.id}}" method="post" class="inline-form"
                            onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é?');">
                            <button type="submit" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é</button>
                        </form>
                    </div>
                </form>
            </section>
        </main>
    </div>
</body>

</html>